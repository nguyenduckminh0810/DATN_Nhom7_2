<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test API S·∫£n Ph·∫©m M·ªõi</title>
  </head>
  <body>
    <h1>Test API S·∫£n Ph·∫©m M·ªõi</h1>
    <button onclick="testAPI()">Test API</button>
    <div id="result"></div>

    <script>
      async function testAPI() {
        const resultDiv = document.getElementById("result");
        resultDiv.innerHTML = "ƒêang g·ªçi API...";

        try {
          const url =
            "http://localhost:8080/api/san-pham?sortBy=taoLuc&sortOrder=desc&status=active&inStock=true&size=10";
          console.log("üîç Calling API:", url);

          const response = await fetch(url);
          const data = await response.json();

          console.log("üìã API Response:", data);

          if (data && data.content) {
            let html = `<h3>‚úÖ K·∫øt qu·∫£ API (${data.content.length} s·∫£n ph·∫©m):</h3>`;

            // Show product cards with images
            html +=
              '<div style="display: flex; gap: 10px; flex-wrap: wrap; margin: 20px 0;">';
            data.content.forEach((product) => {
              const imageUrl = product.anhDaiDien
                ? `http://localhost:8080${product.anhDaiDien}`
                : "https://via.placeholder.com/200x250?text=No+Image";
              html += `
                    <div style="border: 1px solid #ddd; padding: 10px; width: 200px;">
                        <h4>${product.ten}</h4>
                        <img src="${imageUrl}" alt="${
                product.ten
              }" style="width: 100%; height: 200px; object-fit: cover;" 
                             onerror="this.src='https://via.placeholder.com/200x250?text=Error+Loading'" />
                        <p>Gi√°: ${product.gia}ƒë</p>
                        <p>Tr·∫°ng th√°i: ${product.trangThai}</p>
                        <p>T·ªìn kho: ${product.tonKho}</p>
                        <small>URL ·∫£nh: ${
                          product.anhDaiDien || "Kh√¥ng c√≥"
                        }</small>
                    </div>
                `;
            });
            html += "</div>";

            html += `<details><summary>Raw JSON Response</summary><pre>${JSON.stringify(
              data,
              null,
              2
            )}</pre></details>`;
            resultDiv.innerHTML = html;
          } else {
            resultDiv.innerHTML = `
                        <h3>‚ö†Ô∏è API tr·∫£ v·ªÅ d·ªØ li·ªáu kh√¥ng nh∆∞ mong ƒë·ª£i:</h3>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
          }
        } catch (error) {
          console.error("‚ùå L·ªói API:", error);
          resultDiv.innerHTML = `
                    <h3>‚ùå L·ªói khi g·ªçi API:</h3>
                    <p>${error.message}</p>
                    <p>ƒê·∫£m b·∫£o backend ƒëang ch·∫°y tr√™n http://localhost:8080</p>
                `;
        }
      }
    </script>
  </body>
</html>
